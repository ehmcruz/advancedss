#define X8664_DEC_ADD_EB_GB_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	\
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)  \
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, reg_src) \
	\
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 1)

#define X8664_DEC_ADD_EB_GB_MEM_16BITS

#define X8664_DEC_ADD_EB_GB_MEM_32BITS

#define X8664_DEC_ADD_EB_GB_MEM_64BITS

#define X8664_DEC_ADD_EB_GB_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

#define X8664_DEC_ADD_EV_GV_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_DEC_ADD_EV_GV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 2)

#define X8664_DEC_ADD_EV_GV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 4)

#define X8664_DEC_ADD_EV_GV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 8)

#define X8664_DEC_ADD_EV_GV_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_DEC_ADD_GB_EB_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0) \
	\
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_8_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)

#define X8664_DEC_ADD_GB_EB_MEM_16BITS

#define X8664_DEC_ADD_GB_EB_MEM_32BITS

#define X8664_DEC_ADD_GB_EB_MEM_64BITS

#define X8664_DEC_ADD_GB_EB_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_DEC_ADD_GV_EV_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_DEC_ADD_GV_EV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_16_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)

#define X8664_DEC_ADD_GV_EV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_32_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)

#define X8664_DEC_ADD_GV_EV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_64_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)

#define X8664_DEC_ADD_GV_EV_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

#define X8664_DEC_ADC_EB_GB_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	\
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)  \
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, reg_src) \
	CPU_X8664_DEC_CHECK_RFLAGS_DEP(2, CPU_X8664_FLAGS_POS_CF) \
	\
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 1)

#define X8664_DEC_ADC_EB_GB_MEM_16BITS

#define X8664_DEC_ADC_EB_GB_MEM_32BITS

#define X8664_DEC_ADC_EB_GB_MEM_64BITS

#define X8664_DEC_ADC_EB_GB_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

#define X8664_DEC_ADC_EV_GV_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0) \
	CPU_X8664_DEC_CHECK_RFLAGS_DEP(2, CPU_X8664_FLAGS_POS_CF)

#define X8664_DEC_ADC_EV_GV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 2)

#define X8664_DEC_ADC_EV_GV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 4)

#define X8664_DEC_ADC_EV_GV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 8)

#define X8664_DEC_ADC_EV_GV_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_DEC_ADC_GB_EB_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0) \
	CPU_X8664_DEC_CHECK_RFLAGS_DEP(2, CPU_X8664_FLAGS_POS_CF) \
	\
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_8_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)

#define X8664_DEC_ADC_GB_EB_MEM_16BITS

#define X8664_DEC_ADC_GB_EB_MEM_32BITS

#define X8664_DEC_ADC_GB_EB_MEM_64BITS

#define X8664_DEC_ADC_GB_EB_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_DEC_ADC_GV_EV_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0) \
	CPU_X8664_DEC_CHECK_RFLAGS_DEP(2, CPU_X8664_FLAGS_POS_CF)

#define X8664_DEC_ADC_GV_EV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_16_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)

#define X8664_DEC_ADC_GV_EV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_32_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)

#define X8664_DEC_ADC_GV_EV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(2, reg_dst) \
	CPU_X8664_DEC_SET_GPR_64_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)

#define X8664_DEC_ADC_GV_EV_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

#define X8664_DEC_CMP_EB_GB_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	\
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)  \
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, reg_src) \
	\
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)

#define X8664_DEC_CMP_EB_GB_MEM_16BITS

#define X8664_DEC_CMP_EB_GB_MEM_32BITS

#define X8664_DEC_CMP_EB_GB_MEM_64BITS

#define X8664_DEC_CMP_EB_GB_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

#define X8664_DEC_CMP_EV_GV_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_DEC_CMP_EV_GV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)

#define X8664_DEC_CMP_EV_GV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)

#define X8664_DEC_CMP_EV_GV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(2, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)

#define X8664_DEC_CMP_EV_GV_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_DEC_CMP_GB_EB_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0) \
	\
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)

#define X8664_DEC_CMP_GB_EB_MEM_16BITS

#define X8664_DEC_CMP_GB_EB_MEM_32BITS

#define X8664_DEC_CMP_GB_EB_MEM_64BITS

#define X8664_DEC_CMP_GB_EB_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_DEC_CMP_GV_EV_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_DEC_CMP_GV_EV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)

#define X8664_DEC_CMP_GV_EV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)

#define X8664_DEC_CMP_GV_EV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(2, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)

#define X8664_DEC_CMP_GV_EV_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

#define X8664_MOV_EB_GB_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	\
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)  \
	CPU_X8664_DEC_CHECK_GPR_8_DEP(1, reg_src) \
	\
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(1, vaddr, 1)

#define X8664_MOV_EB_GB_MEM_16BITS

#define X8664_MOV_EB_GB_MEM_32BITS

#define X8664_MOV_EB_GB_MEM_64BITS

#define X8664_MOV_EB_GB_MEM_TAIL

/******************************************************************/

#define X8664_MOV_EV_GV_MEM_HEAD \
	uint8_t reg_src; \
	bx_address vaddr; \
	reg_src = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_MOV_EV_GV_MEM_16BITS \
	CPU_X8664_DEC_CHECK_GPR_16_DEP(1, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(1, vaddr, 2)

#define X8664_MOV_EV_GV_MEM_32BITS \
	CPU_X8664_DEC_CHECK_GPR_32_DEP(1, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(	1, vaddr, 4)

#define X8664_MOV_EV_GV_MEM_64BITS \
	CPU_X8664_DEC_CHECK_GPR_64_DEP(1, reg_src) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(1, vaddr, 8)

#define X8664_MOV_EV_GV_MEM_TAIL
/******************************************************************/
#define X8664_MOV_GB_EB_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0) \
	\
	CPU_X8664_DEC_SET_GPR_8_DEP(1, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)

#define X8664_MOV_GB_EB_MEM_16BITS

#define X8664_MOV_GB_EB_MEM_32BITS

#define X8664_MOV_GB_EB_MEM_64BITS

#define X8664_MOV_GB_EB_MEM_TAIL
/******************************************************************/
#define X8664_MOV_GV_EV_MEM_HEAD \
	uint8_t reg_dst; \
	bx_address vaddr; \
	\
	reg_dst = MODRM_GET_G; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_MOV_GV_EV_MEM_16BITS \
	CPU_X8664_DEC_SET_GPR_16_DEP(1, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)

#define X8664_MOV_GV_EV_MEM_32BITS \
	CPU_X8664_DEC_SET_GPR_32_DEP(1, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)

#define X8664_MOV_GV_EV_MEM_64BITS \
	CPU_X8664_DEC_SET_GPR_64_DEP(1, reg_dst) \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)

#define X8664_MOV_GV_EV_MEM_TAIL
/******************************************************************/
#define X8664_GROUP_1_8BITS_MEM_HEAD \
	bx_address vaddr; \
	\
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)  \
	\
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 1)

#define X8664_GROUP_1_8BITS_MEM_16BITS

#define X8664_GROUP_1_8BITS_MEM_32BITS

#define X8664_GROUP_1_8BITS_MEM_64BITS

#define X8664_GROUP_1_8BITS_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_GROUP_1_ZBITS_MEM_HEAD \
	bx_address vaddr; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_GROUP_1_ZBITS_MEM_16BITS \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 2)

#define X8664_GROUP_1_ZBITS_MEM_32BITS \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 4)

#define X8664_GROUP_1_ZBITS_MEM_64BITS \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 8)

#define X8664_GROUP_1_ZBITS_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_GROUP_2_CL_8BITS_MEM_HEAD \
	bx_address vaddr; \
	\
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)  \
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, BX_8BIT_REG_CL)\
	\
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 1)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 1)

#define X8664_GROUP_2_CL_8BITS_MEM_16BITS

#define X8664_GROUP_2_CL_8BITS_MEM_32BITS

#define X8664_GROUP_2_CL_8BITS_MEM_64BITS

#define X8664_GROUP_2_CL_8BITS_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/
#define X8664_GROUP_2_CL_ZBITS_MEM_HEAD \
	bx_address vaddr; \
	vaddr = MODRM_GET_CALCULATED_MEMORY_ADDR; \
	\
	CPU_X8664_CREATE_MICROCODE_LINK(1, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 0)    \
	CPU_X8664_CREATE_MICROCODE_LINK(2, 1)    \
	CPU_X8664_CREATE_MICROCODE_LINK(3, 2)    \
	\
	CPU_X8664_DEC_CHECK_GPR_8_DEP(2, BX_8BIT_REG_CL)\
	CPU_X8664_DEC_CHECK_MODRM_MEMORY_DEP(0)

#define X8664_GROUP_2_CL_ZBITS_MEM_16BITS \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 2)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 2)

#define X8664_GROUP_2_CL_ZBITS_MEM_32BITS \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 4)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 4)

#define X8664_GROUP_2_CL_ZBITS_MEM_64BITS \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_LOAD(1, vaddr, 8)     \
	CPU_X8664_SET_RESULT_TYPE_MEMORY_STORE(3, vaddr, 8)

#define X8664_GROUP_2_CL_ZBITS_MEM_TAIL \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_CF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_PF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_AF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_ZF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_SF ) \
	CPU_X8664_DEC_SET_RFLAGS_DEP( 2, CPU_X8664_FLAGS_POS_OF )

/******************************************************************/

